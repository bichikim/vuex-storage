var VuexStorage=function(e,t,o){"use strict";var i=function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=!0),this._init=!1;var o=e.req,i=e.res;this._req=o,this._res=i,this._isClient=t,this._updateCookie(),this._init=!0}return Object.defineProperty(e.prototype,"isClient",{get:function(){return this._isClient},enumerable:!0,configurable:!0}),e.prototype.get=function(e,t){this._updateCookie(t);var o=this._cookies[e];try{return JSON.parse(o)}catch(e){return o}},e.prototype.remove=function(e,t){delete this._cookies[e],this._saveCookie(e,void 0,t)},e.prototype.set=function(e,t,o){var i=t;"object"==typeof i&&(i=JSON.stringify(t)),this._cookies[e]=t,this._saveCookie(e,i,o)},e.prototype._updateCookie=function(e){if(this.isClient)this._cookies=o.parse(document.cookie,e);else{this._cookies={};var r=this._req;if(r&&(r.cookies||r.headers)){var s=r.cookies||r.headers.cookie;this._cookies="object"==typeof s?i({},s):o.parse(s,e)}var n=this._res,a=n&&n.getHeader("set-cookie");a&&(this._cookies=t.merge(this._cookies,o.parse(a.toString(),e)))}},e.prototype._saveCookie=function(e,t,i){if(void 0===t&&(t=""),this.isClient)document.cookie=o.serialize(e,t,i);else{var r=this._res;if(r){var s=new RegExp("^"+e+"="),n=(r.getHeader("set-cookie")||"").toString().split(";").filter((function(e){return!s.test(e)}));n.push(o.serialize(e,t,i)),r.setHeader("set-cookie",n.join("; "))}}},e}(),s="vuex",n="vuex-filters",a="localStorage",c="__RESTORE_MUTATION";function l(e,o,i){var r=t.cloneDeep(e),s={};return i||o?(s=i?t.pick(r,i):r,o&&(s=t.omit(s,o)),s):s}var u=function(e){var o=this;void 0===e&&(e={});var u=e.restore,v=void 0===u||u,f=e.strict,p=void 0!==f&&f,h=e.key,g=void 0===h?s:h,_=e.mutationName,d=void 0===_?c:_,k=e.storageFirst,y=void 0===k||k,S=e.filter,m=void 0===S?{}:S,w=e.clientSide,O=e.filterSaveKey,N=void 0===O?n:O,E=e.filterSaveMethod,x=void 0===E?a:E,I=function(){return"function"==typeof w?w(o._store,e):"boolean"==typeof w?w:"object"==typeof document},b=function(){return m?function(e){return{cookie:t.get(o._store.state,e.cookie||""),session:t.get(o._store.state,e.session||""),local:t.get(o._store.state,e.local||"")}}(m):{}};this.mutationName=d,this.mutation=function(e,t){var o=this._vm;Object.keys(t).forEach((function(i){o.$set(e,i,t[i])}))},this.clear=function(e){if(new r(e,I()).set(g,{},{path:"/"}),I()){var t=window.sessionStorage,o=window.localStorage;t.setItem(g,"{}"),o.setItem(g,"{}")}};var C=function(e){var i=o._store,r=e,s=t.cloneDeep(i.state);r=y?t.merge(s,e):t.merge(e,s),p?i.commit(d,r):i.replaceState(r)};this.restoreFilter=function(e){var o={},i={};if("localStorage"===x){if(!I())return;(s=localStorage.getItem(N))&&(o=JSON.parse(localStorage.getItem(N)||"{}"))}else{var s;(s=new r(e,I()).get(N))&&(i=s)}C(t.merge(o,i))},this.restore=function(e){var o={},i=b(),s=i.cookie,n=i.session,a=i.local;s&&(o=l(new r(e,I()).get(g),s.except,s.only));var c={},u={};if(I()){var v="{}",f="{}";n&&(v=sessionStorage.getItem(g)||"{}",c=l(JSON.parse(v),n.except,n.only)),a&&(f=localStorage.getItem(g)||"{}",u=l(JSON.parse(f),a.except,a.only))}C(t.merge(c,u,o))},this.saveFilter=function(e,t){var o=[],i=m.local,s=m.cookie,n=m.session;if(i&&o.push(i),s&&o.push(s),n&&o.push(n),"localStorage"===x){if(!I())return;localStorage.setItem(N,JSON.stringify(l(e,void 0,o)))}else new r(t,I()).set(N,l(e,void 0,o),{path:"/"})},this.save=function(e,t){var o=b(),s=o.cookie,n=o.session,a=o.local,c=new r(t,I());if(s&&c){var u=s.options,v=void 0===u?{}:u;c.set(g,l(e,s.except,s.only),i({path:"/"},v))}if(I()){var f=window.sessionStorage,p=window.localStorage;n&&f.setItem(g,JSON.stringify(l(e,n.except,n.only))),a&&p.setItem(g,JSON.stringify(l(e,a.except,a.only)))}},this.nuxtServerInit=function(e,t){o.restoreFilter(t),v&&o.restore(t),o.clear(),o.saveFilter(o._store.state,t),o.save(o._store.state,t)},this.plugin=function(e){if(o._store)throw new Error("plugin install twice");o._store=e;var t=function(e){o.restoreFilter(),v&&o.restore(),o.clear(),o.saveFilter(e.state),o.save(e.state),e.subscribe((function(e,t){o.clear(),o.saveFilter(t),o.save(t)}))};I()&&window.onNuxtReady?window.onNuxtReady((function(){return t(e)})):process.server||t(e)}};return e.DEFAULT_KEY=s,e.DEFAULT_MUTATION_NAME=c,e.DEFAULT_SAVE_METHOD=a,e.FILTERS_KEY=n,e.default=u,e}({},_,Cookie);
